name: gettext
version: 0.24.0
release: 1
url: https://ftp.gnu.org/gnu/gettext/gettext-0.24.tar.xz
homepage: https://www.gnu.org/software/gettext/
license: GPL-3.0-or-later
summary: Localisation support for programs
description: |
  The Gettext package contains utilities for internationalization and localization. These allow programs to be compiled with NLS (Native Language Support), enabling them to output messages in the user's native language.
phase: 4
order: 155
critical: true
#builddeps: [make]
buildsteps: |
  export CC="clang"
  export CXX="clang++"
  export CFLAGS="-std=gnu99 --sysroot=$LFS"
  export LDFLAGS="--sysroot=$LFS -Wl,--dynamic-linker=/lib/ld-musl-x86_64.so.1"
  export PKG_CONFIG_SYSROOT_DIR="$LFS"
  export PKG_CONFIG_PATH="$LFS/usr/lib/pkgconfig:$LFS/usr/share/pkgconfig"    
  
  ./configure --prefix=$LFS/usr    \
              --docdir=/usr/share/doc/gettext-{version} \
              --host=x86_64-linux-musl

  make

  if [ "$RUN_TESTS" = "1" ]; then
      set +e
      make check
      set -e
  fi

  make install
  chmod 0755 $LFS/usr/lib/preloadable_libintl.so
builddeps: []
