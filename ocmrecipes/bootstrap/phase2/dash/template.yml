name: dash
version: 0.5.12
release: 1
url: http://gondor.apana.org.au/~herbert/dash/files/dash-0.5.12.tar.gz
homepage: https://git.kernel.org/pub/scm/utils/dash/dash.git/
license: BSD-3-Clause
summary: A POSIX-compliant Unix shell optimized for speed
description: |
  Dash is a POSIX-compliant shell that is much smaller than bash. It is useful for systems where performance and small size are important. It is often used as /bin/sh in minimal Linux environments.
phase: 2
order: 17
builddeps: [make, clang, musl]
buildsteps: |
  export CC="clang"
  export CXX="clang++"
  export CFLAGS="-std=gnu99 --sysroot=$LFS -static -I$LFS/usr/include -D_POSIX_C_SOURCE=200809L -D_XOPEN_SOURCE=700 -Wno-error=implicit-function-declaration"
  export LDFLAGS="--sysroot=$LFS -Wl,--dynamic-linker=/lib/ld-musl-x86_64.so.1"
  export PKG_CONFIG_SYSROOT_DIR="$LFS"
  export PKG_CONFIG_PATH="$LFS/usr/lib/pkgconfig:$LFS/usr/share/pkgconfig"  

  ./configure --bindir=$LFS/bin --mandir=$LFS/usr/share/man --host=x86_64-linux-musl &&
  make
  make install

  cat >> $LFS/etc/shells << "EOF"
  /bin/dash
  EOF
  # This is optional. Most linux packages assume /bin/sh -> bash
  ln -svf dash $LFS/bin/sh
