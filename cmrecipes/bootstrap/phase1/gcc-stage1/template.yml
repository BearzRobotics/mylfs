name: gcc-stage1
version: 14.2.0
release: 1

homepage: https://gcc.gnu.org/

license: GPL-3.0-or-later WITH GCC-exception-3.1
summary: stub of libcppstd
phase: 1
order: 7



buildsteps: |
  #export CFLAGS="-std=gnu99"
  export CC=x86_64-lfs-linux-musl-gcc
  export CXX=x86_64-lfs-linux-musl-g++
  export CFLAGS="--sysroot=$LFS"
  export LDFLAGS="--sysroot=$LFS --dynamic-linker=$LFS/lib/ld-musl-x86_64.so.1"
  unset GCC_NO_EXECUTABLES
  
  ls ../../gcc-stage0 
  cd ../../gcc-stage0/source/build

  

  make all-gcc           # build the compiler frontends (C + C++)
  make all-target-libgcc # build libgcc for linking
  make all               # build everything else, including libstdc++ for C++
  make install           # install the compiler and runtime libraries

  for tool in ; do
      src="$LFS/tools/bin/$tool"
      dst="$LFS/tools/bin/$tool"
      
      if [ -f "$src" ]; then
          ln -sf "$src" "$dst"
          echo "Linked $src -> $dst"
      else
          echo "Warning: $src does not exist"
      fi
  done

  ln -sfv $LFS/tools/bin/x86_64-lfs-linux-musl-gcc $LFS/tools/bin/gcc
  ln -sfv $LFS/tools/bin/x86_64-lfs-linux-musl-g++ $LFS/tools/bin/g++
  